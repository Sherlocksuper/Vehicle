import {Socket} from "net";
import {senderForDown} from "./public/config.js";
import {CanConfig} from "./toboard/configClass.js";

//使能：ff 00 02 02 0E
// 挂起：ff 00 02 02 0D
// 逆初始化 ： ff 00 02 02 DD
// 配置波特率（500K为例）： ff 00 02 02 C1 00 00 01 F4
// 配置解析配置（FrameID = 9为例）：ff 00 02 02 C2 00 00 00 00 09 01 00 20 05 05
// 配置解析配置（FrameID = A为例）：ff 00 02 02 C2 01 00 00 00 0A 01 00 20 05 05
// 配置解析配置(FrameID = C为例)  ：ff 00 02 02 C2 02 00 00 00 0C 04 00 20 01 01 08 20 01 01 16 04 01 01 17 04 01 01

senderForDown.write(Buffer.from([0xff, 0x00, 0x02, 0x02, 0x0d]))
senderForDown.write(Buffer.from([0xff, 0x00, 0x02, 0x02, 0xc1, 0x00, 0x00, 0x01, 0xf4]))
senderForDown.write(Buffer.from([0xff, 0x00, 0x02, 0x02, 0xc2, 0x00, 0x00, 0x00, 0x00, 0x09, 0x01, 0x00, 0x20, 0x05, 0x05]))
senderForDown.write(Buffer.from([0xff, 0x00, 0x02, 0x02, 0xc2, 0x01, 0x00, 0x00, 0x00, 0x0a, 0x01, 0x00, 0x20, 0x05, 0x05]))
senderForDown.write(Buffer.from([0xff, 0x00, 0x02, 0x02, 0xc2, 0x02, 0x00, 0x00, 0x00, 0x0c, 0x04, 0x00, 0x20, 0x01, 0x01, 0x08, 0x20, 0x01, 0x01, 0x16, 0x04, 0x01, 0x01, 0x17, 0x04, 0x01, 0x01]))
senderForDown.write(Buffer.from([0xff, 0x00, 0x02, 0x02, 0x0e]))

//初始化
CanConfig.setFunctionCode(0x0d).send()
//配置波特率
CanConfig.setFunctionCode(0xc1).setFrameId([0x00, 0x00, 0x01, 0xf4]).send()
//配置解析配置
CanConfig.setFunctionCode(0xc2).setFrameId([0x00, 0x00, 0x00, 0x00, 0x09]).send()

